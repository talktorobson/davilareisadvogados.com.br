<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D'Ávila Reis Advogados - Sistema de Gestão</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        .chart-bar {
            transition: all 0.3s ease;
        }
        .chart-bar:hover {
            opacity: 0.8;
        }
        /* Fix for dynamic color classes */
        .bg-blue-100 { background-color: #dbeafe; }
        .text-blue-600 { color: #2563eb; }
        .bg-yellow-100 { background-color: #fef3c7; }
        .text-yellow-600 { color: #d97706; }
        .bg-green-100 { background-color: #dcfce7; }
        .text-green-600 { color: #16a34a; }
        .bg-red-100 { background-color: #fee2e2; }
        .text-red-600 { color: #dc2626; }
        .text-blue-800 { color: #1e40af; }
        .text-yellow-800 { color: #92400e; }
        .text-green-800 { color: #166534; }
        .text-red-800 { color: #991b1b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // Mock Data
        const mockClients = [
            { id: 1, name: 'Tech Solutions LTDA', email: 'contato@techsolutions.com', phone: '(11) 3456-7890', cpf_cnpj: '12.345.678/0001-90', type: 'company', status: 'client', value: 15000 },
            { id: 2, name: 'João Silva', email: 'joao.silva@email.com', phone: '(11) 98765-4321', cpf_cnpj: '123.456.789-00', type: 'individual', status: 'client', value: 5000 },
            { id: 3, name: 'Maria Santos', email: 'maria@empresa.com', phone: '(11) 99999-8888', cpf_cnpj: '987.654.321-00', type: 'individual', status: 'lead', value: 0 },
            { id: 4, name: 'Startup Inovadora', email: 'hello@startup.com', phone: '(11) 3333-4444', cpf_cnpj: '98.765.432/0001-10', type: 'company', status: 'prospect', value: 0 },
        ];

        const mockProposals = [
            { id: 1, clientId: 1, clientName: 'Tech Solutions LTDA', title: 'Consultoria Jurídica Mensal', value: 8000, status: 'sent', validUntil: '2025-02-28', createdAt: '2025-01-15' },
            { id: 2, clientId: 2, clientName: 'João Silva', title: 'Assessoria Trabalhista', value: 3500, status: 'accepted', validUntil: '2025-02-15', createdAt: '2025-01-10' },
            { id: 3, clientId: 3, clientName: 'Maria Santos', title: 'Análise Contratual', value: 2500, status: 'draft', validUntil: '2025-03-01', createdAt: '2025-01-20' },
        ];

        const mockContracts = [
            { id: 1, clientId: 1, clientName: 'Tech Solutions LTDA', number: 'CTR-2025-0001', title: 'Contrato de Consultoria', value: 8000, status: 'active', startDate: '2025-01-01', endDate: '2025-12-31' },
            { id: 2, clientId: 2, clientName: 'João Silva', number: 'CTR-2025-0002', title: 'Assessoria Trabalhista', value: 3500, status: 'pending_signature', startDate: '2025-02-01', endDate: '2026-01-31' },
        ];

        const mockInvoices = [
            { id: 1, clientId: 1, clientName: 'Tech Solutions LTDA', number: 'FAT-2025-0001', value: 8000, dueDate: '2025-02-10', status: 'paid', paidDate: '2025-02-08' },
            { id: 2, clientId: 1, clientName: 'Tech Solutions LTDA', number: 'FAT-2025-0002', value: 8000, dueDate: '2025-03-10', status: 'sent', paidDate: null },
            { id: 3, clientId: 2, clientName: 'João Silva', number: 'FAT-2025-0003', value: 3500, dueDate: '2025-01-05', status: 'overdue', paidDate: null },
        ];

        // Context
        const AppContext = createContext();

        const AppProvider = ({ children }) => {
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentView, setCurrentView] = useState('dashboard');
            const [clients, setClients] = useState(mockClients);
            const [proposals, setProposals] = useState(mockProposals);
            const [contracts, setContracts] = useState(mockContracts);
            const [invoices, setInvoices] = useState(mockInvoices);
            const [showNotification, setShowNotification] = useState(false);
            const [notificationMessage, setNotificationMessage] = useState('');

            const showToast = (message) => {
                setNotificationMessage(message);
                setShowNotification(true);
                setTimeout(() => setShowNotification(false), 3000);
            };

            const value = {
                isLoggedIn, setIsLoggedIn,
                currentView, setCurrentView,
                clients, setClients,
                proposals, setProposals,
                contracts, setContracts,
                invoices, setInvoices,
                showToast
            };

            return (
                <AppContext.Provider value={value}>
                    {children}
                    {showNotification && (
                        <div className="fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg fade-in z-50">
                            <i className="fas fa-check-circle mr-2"></i>
                            {notificationMessage}
                        </div>
                    )}
                </AppContext.Provider>
            );
        };

        const useApp = () => {
            const context = useContext(AppContext);
            if (!context) {
                throw new Error('useApp must be used within AppProvider');
            }
            return context;
        };

        // Login Component
        const Login = () => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [showPassword, setShowPassword] = useState(false);
            const { setIsLoggedIn, showToast } = useApp();

            const handleLogin = (e) => {
                e.preventDefault();
                if (email && password) {
                    setIsLoggedIn(true);
                    showToast('Login realizado com sucesso!');
                } else {
                    showToast('Por favor, preencha todos os campos!');
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                    <div className="max-w-md w-full fade-in">
                        <div className="bg-white rounded-2xl shadow-xl p-8">
                            <div className="text-center mb-8">
                                <div className="inline-flex items-center justify-center w-20 h-20 bg-blue-600 rounded-full mb-4">
                                    <i className="fas fa-balance-scale text-white text-3xl"></i>
                                </div>
                                <h1 className="text-3xl font-bold text-gray-900">D'Ávila Reis</h1>
                                <p className="text-gray-600 mt-2">Sistema de Gestão Jurídica</p>
                            </div>
                            
                            <form onSubmit={handleLogin} className="space-y-6">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                    <input
                                        type="email"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        className="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                                        placeholder="seu@email.com"
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                                    <div className="relative">
                                        <input
                                            type={showPassword ? 'text' : 'password'}
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            className="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition pr-12"
                                            placeholder="••••••••"
                                            required
                                        />
                                        <button
                                            type="button"
                                            onClick={() => setShowPassword(!showPassword)}
                                            className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                                        >
                                            <i className={`fas ${showPassword ? 'fa-eye-slash' : 'fa-eye'}`}></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <button
                                    type="submit"
                                    className="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition transform hover:scale-105"
                                >
                                    Entrar
                                </button>
                            </form>

                            <p className="text-center text-sm text-gray-500 mt-6">
                                Demonstração do Sistema ERP/CRM
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // Sidebar Component
        const Sidebar = () => {
            const { currentView, setCurrentView, setIsLoggedIn } = useApp();

            const menuItems = [
                { id: 'dashboard', icon: 'fa-chart-line', label: 'Dashboard' },
                { id: 'clients', icon: 'fa-users', label: 'Clientes' },
                { id: 'proposals', icon: 'fa-file-alt', label: 'Propostas' },
                { id: 'contracts', icon: 'fa-file-contract', label: 'Contratos' },
                { id: 'invoices', icon: 'fa-file-invoice-dollar', label: 'Faturas' },
                { id: 'financial', icon: 'fa-chart-pie', label: 'Financeiro' },
            ];

            return (
                <aside className="w-64 bg-gray-900 text-white h-screen fixed left-0 top-0 overflow-y-auto slide-in">
                    <div className="p-6 border-b border-gray-800">
                        <div className="flex items-center space-x-3">
                            <div className="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                                <i className="fas fa-balance-scale"></i>
                            </div>
                            <div>
                                <h2 className="text-xl font-bold">D'Ávila Reis</h2>
                                <p className="text-xs text-gray-400">Advogados</p>
                            </div>
                        </div>
                    </div>
                    
                    <nav className="p-4 space-y-2">
                        {menuItems.map((item) => (
                            <button
                                key={item.id}
                                onClick={() => setCurrentView(item.id)}
                                className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition ${
                                    currentView === item.id
                                        ? 'bg-blue-600 text-white'
                                        : 'hover:bg-gray-800 text-gray-300'
                                }`}
                            >
                                <i className={`fas ${item.icon} w-5`}></i>
                                <span>{item.label}</span>
                            </button>
                        ))}
                    </nav>
                    
                    <div className="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-800">
                        <button
                            onClick={() => setIsLoggedIn(false)}
                            className="w-full flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-800 text-gray-300 transition"
                        >
                            <i className="fas fa-sign-out-alt w-5"></i>
                            <span>Sair</span>
                        </button>
                    </div>
                </aside>
            );
        };

        // Dashboard Component
        const Dashboard = () => {
            const { clients, proposals, contracts, invoices } = useApp();

            const stats = [
                { label: 'Clientes Ativos', value: clients.filter(c => c.status === 'client').length, icon: 'fa-users', color: 'blue' },
                { label: 'Propostas em Aberto', value: proposals.filter(p => p.status === 'sent').length, icon: 'fa-file-alt', color: 'yellow' },
                { label: 'Contratos Ativos', value: contracts.filter(c => c.status === 'active').length, icon: 'fa-file-contract', color: 'green' },
                { label: 'Faturas Pendentes', value: invoices.filter(i => i.status === 'sent' || i.status === 'overdue').length, icon: 'fa-file-invoice-dollar', color: 'red' },
            ];

            const monthlyRevenue = [
                { month: 'Jan', value: 45000 },
                { month: 'Fev', value: 52000 },
                { month: 'Mar', value: 48000 },
                { month: 'Abr', value: 61000 },
                { month: 'Mai', value: 58000 },
                { month: 'Jun', value: 65000 },
            ];

            const maxRevenue = Math.max(...monthlyRevenue.map(m => m.value));

            return (
                <div className="fade-in">
                    <h1 className="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        {stats.map((stat, index) => (
                            <div key={index} className="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow">
                                <div className="flex items-center justify-between mb-4">
                                    <div className={`w-12 h-12 bg-${stat.color}-100 rounded-lg flex items-center justify-center`}>
                                        <i className={`fas ${stat.icon} text-${stat.color}-600 text-xl`}></i>
                                    </div>
                                    <span className="text-3xl font-bold text-gray-900">{stat.value}</span>
                                </div>
                                <h3 className="text-sm font-medium text-gray-600">{stat.label}</h3>
                            </div>
                        ))}
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-4">Receita Mensal</h2>
                            <div className="h-64 flex items-end space-x-2">
                                {monthlyRevenue.map((month, index) => (
                                    <div key={index} className="flex-1 flex flex-col items-center">
                                        <div 
                                            className="w-full bg-blue-500 rounded-t chart-bar"
                                            style={{ height: `${(month.value / maxRevenue) * 200}px`, minHeight: '20px' }}
                                        ></div>
                                        <span className="text-xs text-gray-600 mt-2">{month.month}</span>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-4">Atividades Recentes</h2>
                            <div className="space-y-3">
                                <div className="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg">
                                    <div className="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                        <i className="fas fa-user-plus text-green-600"></i>
                                    </div>
                                    <div>
                                        <p className="font-medium">Novo cliente cadastrado</p>
                                        <p className="text-sm text-gray-500">Tech Solutions LTDA - há 2 horas</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg">
                                    <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                        <i className="fas fa-file-signature text-blue-600"></i>
                                    </div>
                                    <div>
                                        <p className="font-medium">Contrato assinado</p>
                                        <p className="text-sm text-gray-500">João Silva - há 5 horas</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg">
                                    <div className="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center">
                                        <i className="fas fa-dollar-sign text-yellow-600"></i>
                                    </div>
                                    <div>
                                        <p className="font-medium">Pagamento recebido</p>
                                        <p className="text-sm text-gray-500">R$ 8.000 - Tech Solutions - há 1 dia</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Clients Component
        const ClientsView = () => {
            const { clients, setClients, showToast } = useApp();
            const [showAddModal, setShowAddModal] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            const [filterStatus, setFilterStatus] = useState('all');

            const filteredClients = clients.filter(client => {
                const matchesSearch = client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                     client.email.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesStatus = filterStatus === 'all' || client.status === filterStatus;
                return matchesSearch && matchesStatus;
            });

            const AddClientModal = () => {
                const [formData, setFormData] = useState({
                    name: '', email: '', phone: '', cpf_cnpj: '', type: 'individual', status: 'prospect'
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    const newClient = {
                        ...formData,
                        id: clients.length + 1,
                        value: 0
                    };
                    setClients([...clients, newClient]);
                    showToast('Cliente cadastrado com sucesso!');
                    setShowAddModal(false);
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div className="bg-white rounded-xl shadow-xl max-w-md w-full p-6 fade-in">
                            <h2 className="text-xl font-bold mb-4">Novo Cliente</h2>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Nome</label>
                                    <input
                                        type="text"
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.name}
                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                    <input
                                        type="email"
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.email}
                                        onChange={(e) => setFormData({...formData, email: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                                    <input
                                        type="tel"
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.phone}
                                        onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">CPF/CNPJ</label>
                                    <input
                                        type="text"
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.cpf_cnpj}
                                        onChange={(e) => setFormData({...formData, cpf_cnpj: e.target.value})}
                                    />
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Tipo</label>
                                        <select
                                            className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                            value={formData.type}
                                            onChange={(e) => setFormData({...formData, type: e.target.value})}
                                        >
                                            <option value="individual">Pessoa Física</option>
                                            <option value="company">Pessoa Jurídica</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                        <select
                                            className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                            value={formData.status}
                                            onChange={(e) => setFormData({...formData, status: e.target.value})}
                                        >
                                            <option value="prospect">Prospect</option>
                                            <option value="lead">Lead</option>
                                            <option value="client">Cliente</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="flex justify-end space-x-3 pt-4">
                                    <button
                                        type="button"
                                        onClick={() => setShowAddModal(false)}
                                        className="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
                                    >
                                        Cadastrar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            return (
                <div className="fade-in">
                    <div className="flex justify-between items-center mb-6">
                        <h1 className="text-3xl font-bold text-gray-900">Clientes</h1>
                        <button
                            onClick={() => setShowAddModal(true)}
                            className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center space-x-2"
                        >
                            <i className="fas fa-plus"></i>
                            <span>Novo Cliente</span>
                        </button>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm p-4 mb-6">
                        <div className="flex flex-col md:flex-row gap-4">
                            <div className="flex-1">
                                <div className="relative">
                                    <i className="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input
                                        type="text"
                                        placeholder="Buscar clientes..."
                                        className="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                </div>
                            </div>
                            <select
                                className="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                value={filterStatus}
                                onChange={(e) => setFilterStatus(e.target.value)}
                            >
                                <option value="all">Todos os Status</option>
                                <option value="prospect">Prospect</option>
                                <option value="lead">Lead</option>
                                <option value="client">Cliente</option>
                            </select>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm overflow-hidden">
                        <table className="w-full">
                            <thead className="bg-gray-50 border-b">
                                <tr>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contato</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CPF/CNPJ</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y">
                                {filteredClients.map((client) => (
                                    <tr key={client.id} className="hover:bg-gray-50">
                                        <td className="px-6 py-4">
                                            <div className="flex items-center">
                                                <div className="w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center mr-3">
                                                    <i className={`fas ${client.type === 'company' ? 'fa-building' : 'fa-user'} text-gray-600`}></i>
                                                </div>
                                                <div>
                                                    <div className="text-sm font-medium text-gray-900">{client.name}</div>
                                                    <div className="text-sm text-gray-500">{client.type === 'company' ? 'Empresa' : 'Pessoa Física'}</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td className="px-6 py-4">
                                            <div className="text-sm text-gray-900">{client.email}</div>
                                            <div className="text-sm text-gray-500">{client.phone}</div>
                                        </td>
                                        <td className="px-6 py-4 text-sm text-gray-900">{client.cpf_cnpj}</td>
                                        <td className="px-6 py-4">
                                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                                client.status === 'client' ? 'bg-green-100 text-green-800' :
                                                client.status === 'lead' ? 'bg-yellow-100 text-yellow-800' :
                                                'bg-blue-100 text-blue-800'
                                            }`}>
                                                {client.status === 'client' ? 'Cliente' :
                                                 client.status === 'lead' ? 'Lead' : 'Prospect'}
                                            </span>
                                        </td>
                                        <td className="px-6 py-4 text-sm font-medium">
                                            <button className="text-blue-600 hover:text-blue-900">Ver Detalhes</button>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>

                    {showAddModal && <AddClientModal />}
                </div>
            );
        };

        // Proposals Component
        const ProposalsView = () => {
            const { proposals, clients, setProposals, showToast } = useApp();
            const [showAddModal, setShowAddModal] = useState(false);

            const AddProposalModal = () => {
                const [formData, setFormData] = useState({
                    clientId: '', title: '', value: '', validDays: 30
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    const client = clients.find(c => c.id === parseInt(formData.clientId));
                    if (!client) return;
                    
                    const validUntil = new Date();
                    validUntil.setDate(validUntil.getDate() + parseInt(formData.validDays));
                    
                    const newProposal = {
                        id: proposals.length + 1,
                        clientId: parseInt(formData.clientId),
                        clientName: client.name,
                        title: formData.title,
                        value: parseFloat(formData.value),
                        status: 'draft',
                        validUntil: validUntil.toISOString().split('T')[0],
                        createdAt: new Date().toISOString().split('T')[0]
                    };
                    setProposals([...proposals, newProposal]);
                    showToast('Proposta criada com sucesso!');
                    setShowAddModal(false);
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div className="bg-white rounded-xl shadow-xl max-w-md w-full p-6 fade-in">
                            <h2 className="text-xl font-bold mb-4">Nova Proposta</h2>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
                                    <select
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.clientId}
                                        onChange={(e) => setFormData({...formData, clientId: e.target.value})}
                                    >
                                        <option value="">Selecione um cliente</option>
                                        {clients.map(client => (
                                            <option key={client.id} value={client.id}>{client.name}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Título</label>
                                    <input
                                        type="text"
                                        required
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.title}
                                        onChange={(e) => setFormData({...formData, title: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                                    <input
                                        type="number"
                                        required
                                        min="0"
                                        step="0.01"
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.value}
                                        onChange={(e) => setFormData({...formData, value: e.target.value})}
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Validade (dias)</label>
                                    <input
                                        type="number"
                                        required
                                        min="1"
                                        className="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                        value={formData.validDays}
                                        onChange={(e) => setFormData({...formData, validDays: parseInt(e.target.value)})}
                                    />
                                </div>
                                <div className="flex justify-end space-x-3 pt-4">
                                    <button
                                        type="button"
                                        onClick={() => setShowAddModal(false)}
                                        className="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
                                    >
                                        Criar Proposta
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            const handleSendProposal = (proposalId) => {
                setProposals(proposals.map(p => 
                    p.id === proposalId ? {...p, status: 'sent'} : p
                ));
                showToast('Proposta enviada por email!');
            };

            return (
                <div className="fade-in">
                    <div className="flex justify-between items-center mb-6">
                        <h1 className="text-3xl font-bold text-gray-900">Propostas</h1>
                        <button
                            onClick={() => setShowAddModal(true)}
                            className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center space-x-2"
                        >
                            <i className="fas fa-plus"></i>
                            <span>Nova Proposta</span>
                        </button>
                    </div>

                    <div className="grid gap-4">
                        {proposals.map((proposal) => (
                            <div key={proposal.id} className="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition">
                                <div className="flex items-start justify-between">
                                    <div className="flex-1">
                                        <h3 className="text-lg font-semibold text-gray-900">{proposal.title}</h3>
                                        <p className="text-gray-600 mt-1">{proposal.clientName}</p>
                                        <div className="flex items-center space-x-4 mt-4">
                                            <div className="flex items-center text-sm text-gray-500">
                                                <i className="fas fa-dollar-sign mr-1"></i>
                                                <span>R$ {proposal.value.toLocaleString('pt-BR')}</span>
                                            </div>
                                            <div className="flex items-center text-sm text-gray-500">
                                                <i className="fas fa-calendar mr-1"></i>
                                                <span>Válida até {new Date(proposal.validUntil).toLocaleDateString('pt-BR')}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-4">
                                        <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${
                                            proposal.status === 'accepted' ? 'bg-green-100 text-green-800' :
                                            proposal.status === 'sent' ? 'bg-blue-100 text-blue-800' :
                                            'bg-gray-100 text-gray-800'
                                        }`}>
                                            {proposal.status === 'accepted' ? 'Aceita' :
                                             proposal.status === 'sent' ? 'Enviada' : 'Rascunho'}
                                        </span>
                                        {proposal.status === 'draft' && (
                                            <button
                                                onClick={() => handleSendProposal(proposal.id)}
                                                className="text-blue-600 hover:text-blue-900 font-medium"
                                            >
                                                <i className="fas fa-paper-plane mr-1"></i>
                                                Enviar
                                            </button>
                                        )}
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    {showAddModal && <AddProposalModal />}
                </div>
            );
        };

        // Contracts Component
        const ContractsView = () => {
            const { contracts, showToast } = useApp();

            const handleSendForSignature = (contractId) => {
                showToast('Contrato enviado para assinatura via Clicksign!');
            };

            return (
                <div className="fade-in">
                    <h1 className="text-3xl font-bold text-gray-900 mb-6">Contratos</h1>

                    <div className="grid gap-4">
                        {contracts.map((contract) => (
                            <div key={contract.id} className="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition">
                                <div className="flex items-start justify-between">
                                    <div className="flex-1">
                                        <div className="flex items-center space-x-3 mb-2">
                                            <i className="fas fa-file-contract text-gray-600 text-xl"></i>
                                            <h3 className="text-lg font-semibold text-gray-900">{contract.title}</h3>
                                            <span className={`px-3 py-1 text-xs font-semibold rounded-full ${
                                                contract.status === 'active' ? 'bg-green-100 text-green-800' :
                                                'bg-yellow-100 text-yellow-800'
                                            }`}>
                                                {contract.status === 'active' ? 'Ativo' : 'Aguardando Assinatura'}
                                            </span>
                                        </div>
                                        <p className="text-gray-600">{contract.clientName} • {contract.number}</p>
                                        <div className="flex items-center space-x-6 mt-4 text-sm text-gray-500">
                                            <div className="flex items-center">
                                                <i className="fas fa-dollar-sign mr-1"></i>
                                                <span>R$ {contract.value.toLocaleString('pt-BR')}/mês</span>
                                            </div>
                                            <div className="flex items-center">
                                                <i className="fas fa-calendar mr-1"></i>
                                                <span>{new Date(contract.startDate).toLocaleDateString('pt-BR')} - {new Date(contract.endDate).toLocaleDateString('pt-BR')}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        {contract.status === 'pending_signature' && (
                                            <button
                                                onClick={() => handleSendForSignature(contract.id)}
                                                className="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition"
                                            >
                                                <i className="fas fa-signature mr-1"></i>
                                                Enviar para Assinatura
                                            </button>
                                        )}
                                        <button className="px-3 py-1 text-gray-600 hover:bg-gray-100 rounded transition">
                                            <i className="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Invoices Component
        const InvoicesView = () => {
            const { invoices, setInvoices, showToast } = useApp();

            const handleMarkAsPaid = (invoiceId) => {
                setInvoices(invoices.map(inv => 
                    inv.id === invoiceId 
                        ? {...inv, status: 'paid', paidDate: new Date().toISOString().split('T')[0]} 
                        : inv
                ));
                showToast('Fatura marcada como paga!');
            };

            const getStatusColor = (status) => {
                switch (status) {
                    case 'paid': return 'bg-green-100 text-green-800';
                    case 'sent': return 'bg-blue-100 text-blue-800';
                    case 'overdue': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            };

            const getStatusLabel = (status) => {
                switch (status) {
                    case 'paid': return 'Paga';
                    case 'sent': return 'Enviada';
                    case 'overdue': return 'Vencida';
                    default: return status;
                }
            };

            return (
                <div className="fade-in">
                    <h1 className="text-3xl font-bold text-gray-900 mb-6">Faturas</h1>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <div className="flex items-center justify-between mb-2">
                                <h3 className="text-sm font-medium text-gray-600">A Receber</h3>
                                <i className="fas fa-clock text-yellow-600"></i>
                            </div>
                            <p className="text-2xl font-bold text-gray-900">
                                R$ {invoices.filter(i => i.status === 'sent' || i.status === 'overdue')
                                    .reduce((sum, i) => sum + i.value, 0).toLocaleString('pt-BR')}
                            </p>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <div className="flex items-center justify-between mb-2">
                                <h3 className="text-sm font-medium text-gray-600">Recebido</h3>
                                <i className="fas fa-check-circle text-green-600"></i>
                            </div>
                            <p className="text-2xl font-bold text-green-600">
                                R$ {invoices.filter(i => i.status === 'paid')
                                    .reduce((sum, i) => sum + i.value, 0).toLocaleString('pt-BR')}
                            </p>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <div className="flex items-center justify-between mb-2">
                                <h3 className="text-sm font-medium text-gray-600">Vencidas</h3>
                                <i className="fas fa-exclamation-circle text-red-600"></i>
                            </div>
                            <p className="text-2xl font-bold text-red-600">
                                {invoices.filter(i => i.status === 'overdue').length}
                            </p>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm overflow-hidden">
                        <table className="w-full">
                            <thead className="bg-gray-50 border-b">
                                <tr>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fatura</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vencimento</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y">
                                {invoices.map((invoice) => (
                                    <tr key={invoice.id} className="hover:bg-gray-50">
                                        <td className="px-6 py-4 text-sm font-medium text-gray-900">{invoice.number}</td>
                                        <td className="px-6 py-4 text-sm text-gray-900">{invoice.clientName}</td>
                                        <td className="px-6 py-4 text-sm font-medium text-gray-900">
                                            R$ {invoice.value.toLocaleString('pt-BR')}
                                        </td>
                                        <td className="px-6 py-4 text-sm text-gray-900">
                                            {new Date(invoice.dueDate).toLocaleDateString('pt-BR')}
                                            {invoice.paidDate && (
                                                <span className="block text-xs text-gray-500">
                                                    Pago em {new Date(invoice.paidDate).toLocaleDateString('pt-BR')}
                                                </span>
                                            )}
                                        </td>
                                        <td className="px-6 py-4">
                                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(invoice.status)}`}>
                                                {getStatusLabel(invoice.status)}
                                            </span>
                                        </td>
                                        <td className="px-6 py-4">
                                            <div className="flex items-center space-x-2">
                                                {(invoice.status === 'sent' || invoice.status === 'overdue') && (
                                                    <button
                                                        onClick={() => handleMarkAsPaid(invoice.id)}
                                                        className="text-green-600 hover:text-green-900 text-sm font-medium"
                                                    >
                                                        Marcar como Paga
                                                    </button>
                                                )}
                                                <button className="text-gray-600 hover:text-gray-900">
                                                    <i className="fas fa-download"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        // Financial Component
        const FinancialView = () => {
            const { invoices, clients } = useApp();

            const totalRevenue = invoices.filter(i => i.status === 'paid').reduce((sum, i) => sum + i.value, 0);
            const totalPending = invoices.filter(i => i.status === 'sent' || i.status === 'overdue').reduce((sum, i) => sum + i.value, 0);
            const totalClients = clients.filter(c => c.status === 'client').length;

            const revenueByClient = clients.map(client => ({
                name: client.name,
                value: client.value,
                percentage: totalRevenue > 0 ? (client.value / totalRevenue) * 100 : 0
            })).filter(c => c.value > 0).sort((a, b) => b.value - a.value);

            return (
                <div className="fade-in">
                    <h1 className="text-3xl font-bold text-gray-900 mb-6">Financeiro</h1>

                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h3 className="text-sm font-medium text-gray-600 mb-2">Receita Total</h3>
                            <p className="text-2xl font-bold text-gray-900">
                                R$ {totalRevenue.toLocaleString('pt-BR')}
                            </p>
                            <p className="text-sm text-green-600 mt-1">+15% vs mês anterior</p>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h3 className="text-sm font-medium text-gray-600 mb-2">A Receber</h3>
                            <p className="text-2xl font-bold text-gray-900">
                                R$ {totalPending.toLocaleString('pt-BR')}
                            </p>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h3 className="text-sm font-medium text-gray-600 mb-2">Clientes Ativos</h3>
                            <p className="text-2xl font-bold text-gray-900">{totalClients}</p>
                        </div>
                        <div className="bg-white rounded-xl shadow-sm p-6">
                            <h3 className="text-sm font-medium text-gray-600 mb-2">Ticket Médio</h3>
                            <p className="text-2xl font-bold text-gray-900">
                                R$ {totalClients > 0 ? (totalRevenue / totalClients).toLocaleString('pt-BR') : 0}
                            </p>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm p-6">
                        <h2 className="text-lg font-semibold text-gray-900 mb-4">Receita por Cliente</h2>
                        <div className="space-y-4">
                            {revenueByClient.length > 0 ? revenueByClient.map((client, index) => (
                                <div key={index}>
                                    <div className="flex items-center justify-between mb-1">
                                        <span className="text-sm font-medium text-gray-700">{client.name}</span>
                                        <span className="text-sm text-gray-600">
                                            R$ {client.value.toLocaleString('pt-BR')} ({client.percentage.toFixed(1)}%)
                                        </span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                        <div 
                                            className="bg-blue-600 h-2 rounded-full transition-all duration-500"
                                            style={{ width: `${client.percentage}%` }}
                                        ></div>
                                    </div>
                                </div>
                            )) : (
                                <p className="text-gray-500 text-center py-8">Nenhuma receita registrada ainda</p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const { isLoggedIn, currentView } = useApp();

            if (!isLoggedIn) {
                return <Login />;
            }

            const renderCurrentView = () => {
                switch(currentView) {
                    case 'dashboard': return <Dashboard />;
                    case 'clients': return <ClientsView />;
                    case 'proposals': return <ProposalsView />;
                    case 'contracts': return <ContractsView />;
                    case 'invoices': return <InvoicesView />;
                    case 'financial': return <FinancialView />;
                    default: return <Dashboard />;
                }
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <Sidebar />
                    <div className="ml-64">
                        <header className="bg-white shadow-sm border-b">
                            <div className="px-6 py-4">
                                <div className="flex items-center justify-between">
                                    <h2 className="text-xl font-semibold text-gray-800">
                                        Sistema de Gestão Jurídica
                                    </h2>
                                    <div className="flex items-center space-x-4">
                                        <button className="relative text-gray-600 hover:text-gray-900">
                                            <i className="fas fa-bell text-xl"></i>
                                            <span className="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                                        </button>
                                        <div className="flex items-center space-x-2">
                                            <span className="text-sm text-gray-600">Larissa Reis</span>
                                            <div className="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium">
                                                L
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </header>
                        
                        <main className="p-6">
                            {renderCurrentView()}
                        </main>
                    </div>
                </div>
            );
        };

        // Render App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <AppProvider>
                <App />
            </AppProvider>
        );
    </script>
</body>
</html>